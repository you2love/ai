<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI智能体详解 - AI技术学习平台</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <section class="section">
        <div class="container">
            <h2 class="section-title">🤖 AI智能体详解</h2>
            <p class="section-subtitle">自主完成复杂任务的AI系统</p>

            <!-- 什么是智能体 -->
            <div class="card" style="margin-bottom: 2rem;">
                <div class="card-header">
                    <div class="card-icon">🤖</div>
                    <div>
                        <div class="card-title">什么是AI智能体？</div>
                        <div class="card-subtitle">Agent = 感知 + 推理 + 行动</div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="diagram-box">
                        <div class="diagram-title">智能体核心能力</div>
                        <div class="diagram-content">
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   感知环境 → 分析推理 → 制定计划 → 执行行动 → 学习改进           │
│                                                                 │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    │
│   │  感知  │ ➜  │  推理  │ ➜  │  规划  │ ➜  │  行动  │    │
│   └─────────┘    └─────────┘    └─────────┘    └─────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                        </div>
                    </div>

                    <div class="comparison-row" style="margin-top: 1rem;">
                        <div class="comparison-cell" style="font-weight:600;">对比</div>
                        <div class="comparison-cell" style="background:#fef2f2;">传统程序</div>
                        <div class="comparison-cell" style="background:#ecfdf5;">AI智能体</div>
                    </div>
                    <div class="comparison-row">
                        <div class="comparison-cell">行为模式</div>
                        <div class="comparison-cell">预定义规则</div>
                        <div class="comparison-cell">自适应学习</div>
                    </div>
                    <div class="comparison-row">
                        <div class="comparison-cell">决策方式</div>
                        <div class="comparison-cell">固定逻辑</div>
                        <div class="comparison-cell">动态推理</div>
                    </div>
                    <div class="comparison-row">
                        <div class="comparison-cell">目标导向</div>
                        <div class="comparison-cell">需人工规划</div>
                        <div class="comparison-cell">自主规划</div>
                    </div>
                </div>
            </div>

            <!-- 智能体类型 -->
            <h3 style="margin: 2rem 0 1rem; font-size: 1.3rem;">📋 智能体类型</h3>

            <div class="cards-grid">
                <div class="card level-card level-1">
                    <div class="level-badge">🔰 简单反射</div>
                    <p style="font-size:0.9rem; color:#666;">基于规则直接响应</p>
                    <p style="font-size:0.8rem; margin-top:0.5rem; color:#888;">条件→动作</p>
                </div>
                <div class="card level-card level-2">
                    <div class="level-badge">🧠 基于模型</div>
                    <p style="font-size:0.9rem; color:#666;">维护环境模型</p>
                    <p style="font-size:0.8rem; margin-top:0.5rem; color:#888;">状态→模型→动作</p>
                </div>
                <div class="card level-card level-2">
                    <div class="level-badge">🎯 目标导向</div>
                    <p style="font-size:0.9rem; color:#666;">搜索目标路径</p>
                    <p style="font-size:0.8rem; margin-top:0.5rem; color:#888;">目标→规划→执行</p>
                </div>
                <div class="card level-card level-3">
                    <div class="level-badge">🔄 规划智能体</div>
                    <p style="font-size:0.9rem; color:#666;">分治策略</p>
                    <p style="font-size:0.8rem; margin-top:0.5rem; color:#888;">分解→解决→整合</p>
                </div>
                <div class="card level-card level-3">
                    <div class="level-badge">📚 学习智能体</div>
                    <p style="font-size:0.9rem; color:#666;">从经验学习</p>
                    <p style="font-size:0.8rem; margin-top:0.5rem; color:#888;">试错→强化→改进</p>
                </div>
                <div class="card level-card level-3">
                    <div class="level-badge">👥 多智能体</div>
                    <p style="font-size:0.9rem; color:#666;">协作与通信</p>
                    <p style="font-size:0.8rem; margin-top:0.5rem; color:#888;">分工→协作→共识</p>
                </div>
            </div>

            <!-- 核心组件 -->
            <h3 style="margin: 2rem 0 1rem; font-size: 1.3rem;">🧩 智能体核心组件</h3>

            <div class="cards-grid">
                <div class="card">
                    <h4 style="margin-bottom: 1rem;">🛠️ 工具集 (Tools)</h4>
                    <div class="tags">
                        <span class="tag">搜索</span>
                        <span class="tag">计算</span>
                        <span class="tag">API</span>
                        <span class="tag">数据库</span>
                    </div>
                    <p style="font-size:0.85rem; margin-top:0.75rem; color:#666;">
                        智能体可调用的外部能力
                    </p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 1rem;">🧠 记忆系统</h4>
                    <div class="tags">
                        <span class="tag">短期记忆</span>
                        <span class="tag">长期记忆</span>
                        <span class="tag">向量存储</span>
                    </div>
                    <p style="font-size:0.85rem; margin-top:0.75rem; color:#666;">
                        存储对话历史和经验
                    </p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 1rem;">📝 提示工程</h4>
                    <div class="tags">
                        <span class="tag">系统提示</span>
                        <span class="tag">few-shot</span>
                        <span class="tag">CoT</span>
                    </div>
                    <p style="font-size:0.85rem; margin-top:0.75rem; color:#666;">
                        引导智能体行为模式
                    </p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 1rem;">🔄 执行引擎</h4>
                    <div class="tags">
                        <span class="tag">ReAct</span>
                        <span class="tag">Plan-Exec</span>
                        <span class="tag">Tool Use</span>
                    </div>
                    <p style="font-size:0.85rem; margin-top:0.75rem; color:#666;">
                        决策循环和执行逻辑
                    </p>
                </div>
            </div>

            <!-- ReAct模式 -->
            <h3 style="margin: 2rem 0 1rem; font-size: 1.3rem;">🔄 ReAct模式</h3>

            <div class="diagram-box">
                <div class="diagram-title">ReAct = Reasoning + Acting</div>
                <div class="diagram-content">
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   思考(Thought) → 行动(Action) → 观察(Observation) → 循环        │
│                                                                 │
│   1. Thought: 我需要搜索信息来回答这个问题                       │
│   2. Action: search[AI发展历史]                                 │
│   3. Observation: AI始于1956年达特茅斯会议...                    │
│   4. Thought: 找到答案了，可以总结了                            │
│   5. Final Answer: ...                                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- 工具类型 -->
            <h3 style="margin: 2rem 0 1rem; font-size: 1.3rem;">🔧 常见工具类型</h3>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>工具类型</th>
                            <th>示例</th>
                            <th>用途</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>搜索</td><td>SerpAPI, Wikipedia</td><td>网络信息查询</td></tr>
                        <tr><td>计算</td><td>Python REPL, Calculator</td><td>数学计算</td></tr>
                        <tr><td>数据库</td><td>SQL, MongoDB</td><td>数据查询</td></tr>
                        <tr><td>API</td><td>HTTP请求</td><td>第三方服务</td></tr>
                        <tr><td>文件</td><td>读/写文件</td><td>文档处理</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- 应用场景 -->
            <h3 style="margin: 2rem 0 1rem; font-size: 1.3rem;">🚀 应用场景</h3>

            <div class="cards-grid">
                <div class="card">
                    <h4 style="margin-bottom: 0.5rem;">💬 智能客服</h4>
                    <p style="font-size:0.85rem; color:#666;">多轮对话、问题解答</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 0.5rem;">📊 研究助手</h4>
                    <p style="font-size:0.85rem; color:#666;">信息搜集、分析总结</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 0.5rem;">💻 代码助手</h4>
                    <p style="font-size:0.85rem; color:#666;">代码编写、调试、测试</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 0.5rem;">📝 写作助手</h4>
                    <p style="font-size:0.85rem; color:#666;">内容创作、编辑校对</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 0.5rem;">🔄 工作流</h4>
                    <p style="font-size:0.85rem; color:#666;">自动化流程编排</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 0.5rem;">🌐 数据采集</h4>
                    <p style="font-size:0.85rem; color:#666;">信息抓取、整理</p>
                </div>
            </div>

            <h3>💻 代码示例</h3>

            <div class="card">
                <div class="card-header">示例：ReAct智能体实现</div>
                <pre class="code-block"><code class="language-python">"""
ReAct智能体实现：Thought → Action → Observation → ...
- 搜索工具
- 计算工具
- 文件读取工具
- 智能体核心逻辑
"""
from typing import Dict, List, Optional, Tuple
from dataclasses import dataclass
from enum import Enum
import json
import math
import re

class ActionType(Enum):
    SEARCH = "search"
    CALCULATE = "calculate"
    READ_FILE = "read_file"
    LIST_FILES = "list_files"
    FINISH = "finish"

@dataclass
class Action:
    type: ActionType
    input: str

@dataclass
class Step:
    thought: str
    action: Optional[Action]
    observation: str

class Tool:
    """工具基类"""
    
    @property
    def name(self) -> str:
        raise NotImplementedError
    
    @property
    def description(self) -> str:
        raise NotImplementedError
    
    def execute(self, input: str) -> str:
        raise NotImplementedError

class SearchTool(Tool):
    """搜索工具（模拟）"""
    
    @property
    def name(self) -> str:
        return "search"
    
    @property
    def description(self) -> str:
        return "搜索网络信息，返回相关结果"
    
    def execute(self, query: str) -> str:
        # 模拟搜索结果
        knowledge_base = {
            "人工智能": "AI是 Artificial Intelligence 的缩写，研究让机器具有智能的科学。",
            "机器学习": "Machine Learning，让计算机从数据中学习规律的技术。",
            "深度学习": "Deep Learning，使用多层神经网络的机器学习方法。",
            "python": "Python是一种流行的编程语言，适合AI开发。",
            "langchain": "LangChain是一个LLM应用开发框架。"
        }
        
        for key, value in knowledge_base.items():
            if key in query.lower():
                return value
        return f"关于'{query}'的搜索结果：这是一条模拟的搜索结果。"

class CalculatorTool(Tool):
    """计算工具"""
    
    @property
    def name(self) -> str:
        return "calculate"
    
    @property
    def description(self) -> str:
        return "执行数学计算，支持四则运算和函数"
    
    def execute(self, expression: str) -> str:
        try:
            # 安全计算
            allowed_chars = set("0123456789+-*/(). ")
            if not all(c in allowed_chars for c in expression):
                return "错误：包含不允许的字符"
            
            result = eval(expression)
            return f"计算结果: {result}"
        except Exception as e:
            return f"计算错误: {e}"

class FileTool(Tool):
    """文件操作工具"""
    
    def __init__(self):
        self.files = {
            "readme.txt": "这是一个示例文件。\n包含多行文本。",
            "notes.txt": "待办事项：\n1. 学习AI\n2. 实践项目"
        }
    
    @property
    def name(self) -> str:
        return "read_file"
    
    @property
    def description(self) -> str:
        return "读取文件内容"
    
    def execute(self, filename: str) -> str:
        if filename in self.files:
            return self.files[filename]
        return f"文件不存在: {filename}"

class ListFilesTool(Tool):
    """列出文件工具"""
    
    @property
    def name(self) -> str:
        return "list_files"
    
    @property
    def description(self) -> str:
        return "列出可用文件"
    
    def execute(self, input: str) -> str:
        return "可用文件: readme.txt, notes.txt"

class ReActAgent:
    """ReAct智能体 - Reasoning + Acting"""
    
    def __init__(self, tools: List[Tool], max_steps: int = 10):
        self.tools = {tool.name: tool for tool in tools}
        self.max_steps = max_steps
        self.history: List[Step] = []
    
    def think(self, query: str) -> str:
        """生成思考（使用LLM时这里是LLM调用）"""
        # 简化版：基于规则生成思考
        history_text = "\n".join([
            f"思考: {step.thought}\n行动: {step.action}\n观察: {step.observation}"
            for step in self.history[-3:]
        ]) if self.history else "无历史"
        
        prompt = f"""你是一个ReAct智能体，需要通过思考和行动来回答问题。

任务：{query}

历史：
{history_text}

请按照以下格式思考下一步：
Thought: [分析当前情况，决定下一步行动]
Action: [工具名称]([参数]) 或 Finish([最终答案])

可用的工具：
{self._format_tools()}"""

        # 这里简化处理，实际应调用LLM
        return self._simple_reasoning(query)
    
    def _simple_reasoning(self, query: str) -> str:
        """简化推理逻辑（实际使用LLM）"""
        query_lower = query.lower()
        
        # 检查是否需要搜索
        if any(kw in query_lower for kw in ["什么", "定义", "解释", "介绍"]):
            if "计算" in query or any(op in query for op in ["+", "-", "*", "/", "×", "÷"]):
                return "我需要先提取表达式，然后使用计算工具。"
            return "我需要搜索相关信息来回答这个问题。"
        
        # 检查是否需要文件
        if any(kw in query_lower for kw in ["文件", "内容", "read"]):
            return "我需要读取文件来获取信息。"
        
        # 检查是否完成
        if any(kw in query_lower for kw in ["谢谢", "好的", "明白了"]):
            return "Finish(任务完成)"
        
        return "我需要搜索更多信息来回答这个问题。"
    
    def _format_tools(self) -> str:
        return "\n".join([f"- {t.name}: {t.description}" for t in self.tools.values()])
    
    def parse_action(self, thought: str) -> Tuple[Optional[Action], str]:
        """解析行动"""
        # 检查是否结束
        if "Finish(" in thought:
            answer = re.search(r'Finish\((.+?)\)', thought)
            return Action(ActionType.FINISH, answer.group(1) if answer else ""), "finished"
        
        # 解析行动
        for tool_name in self.tools:
            if f"{tool_name}(" in thought:
                param = re.search(rf'{tool_name}\((.+?)\)', thought)
                return Action(ActionType(tool_name), param.group(1) if param else ""), tool_name
        
        return None, "continue"
    
    def run(self, query: str) -> str:
        """执行ReAct循环"""
        self.history = []
        current_query = query
        
        for step_num in range(self.max_steps):
            print(f"\n🔄 步骤 {step_num + 1}")
            
            # 1. Thought
            thought = self.think(current_query)
            print(f"💭 Thought: {thought}")
            
            # 2. Parse Action
            action, status = self.parse_action(thought)
            observation = ""
            
            # 3. Action & Observation
            if action and action.type != ActionType.FINISH:
                print(f"⚡ Action: {action.type.value}[{action.input}]")
                
                tool = self.tools.get(action.type.value)
                if tool:
                    observation = tool.execute(action.input)
                else:
                    observation = "未知工具"
                
                print(f"👀 Observation: {observation}")
            elif status == "finished":
                print(f"✅ 完成: {action.input}")
                return action.input
            
            # 4. 记录步骤
            self.history.append(Step(thought, action, observation))
            
            # 5. 更新查询（包含观察结果）
            current_query = f"基于观察：{observation}\n继续回答：{query}"
        
        return "达到最大步数限制"


# 使用示例
def main():
    # 1. 创建工具
    tools = [
        SearchTool(),
        CalculatorTool(),
        FileTool(),
        ListFilesTool()
    ]
    
    # 2. 创建智能体
    agent = ReActAgent(tools, max_steps=6)
    
    # 3. 测试不同任务
    test_queries = [
        "什么是人工智能？",
        "计算 25 * 4 + 10",
        "readme.txt的内容是什么？"
    ]
    
    for query in test_queries:
        print(f"\n{'='*50}")
        print(f"📝 任务: {query}")
        print("="*50)
        result = agent.run(query)
        print(f"\n🎯 最终答案: {result}")

main()</code></pre>
            </div>

            <div class="card">
                <div class="card-header">代码说明</div>
                <div class="cards-grid" style="margin-top: 1rem;">
                    <div class="card" style="padding: 1rem;">
                        <h4 style="margin-bottom: 0.5rem;">🛠️ 工具类型</h4>
                        <ul style="font-size: 0.85rem; padding-left: 1.2rem;">
                            <li>SearchTool - 搜索信息</li>
                            <li>CalculatorTool - 数学计算</li>
                            <li>FileTool - 读取文件</li>
                            <li>ListFilesTool - 列出文件</li>
                        </ul>
                    </div>
                    <div class="card" style="padding: 1rem;">
                        <h4 style="margin-bottom: 0.5rem;">🔄 ReAct循环</h4>
                        <ul style="font-size: 0.85rem; padding-left: 1.2rem;">
                            <li>Thought - 分析情况</li>
                            <li>Action - 选择工具</li>
                            <li>Observation - 观察结果</li>
                            <li>循环直到完成</li>
                        </ul>
                    </div>
                    <div class="card" style="padding: 1rem;">
                        <h4 style="margin-bottom: 0.5rem;">📊 关键组件</h4>
                        <ul style="font-size: 0.85rem; padding-left: 1.2rem;">
                            <li>Tool基类 - 定义工具接口</li>
                            <li>Action类型 - 区分行动</li>
                            <li>历史记录 - 上下文记忆</li>
                            <li>最大步数 - 防止无限循环</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </section>
</body>
</html>